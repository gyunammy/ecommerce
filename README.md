# Sparta E-Commerce

Kafka 기반 비동기 처리를 활용한 이커머스 프로젝트입니다.

## 🚀 상품 목록 조회 부하 테스트

### 사전 준비

1. **Docker Desktop 실행**

### 부하 테스트 실행 (원클릭)

**자동으로 인프라 시작 → 데이터 초기화 → 삽입 → 부하테스트**를 실행합니다.

```bash
docker-compose --profile k6 up
```

**실행 과정:**
1. **인프라**: MySQL, Redis, Kafka, InfluxDB, Grafana 자동 시작
2. **db-reset**: 테스트 데이터 초기화 + 삽입 (상품 100개)
3. **k6**: 상품 목록 조회 부하 테스트 실행 (1분) → InfluxDB에 메트릭 전송
4. **Grafana**: http://localhost:3000 에서 실시간 대시보드 확인

여러 번 반복 실행해도 일관된 결과를 얻을 수 있습니다.

### 테스트 시나리오

**단계적 부하 증가 (총 1분):**
- **단계 1 (20초)**: 0명 → 100명 증가
- **단계 2 (20초)**: 100명 → 200명 스파이크 (급격한 부하)
- **단계 3 (20초)**: 200명 → 0명 감소

각 가상 사용자는 1-3초 간격으로 `/products` API를 반복 호출합니다.

### 결과 확인

#### 📊 Grafana 대시보드 (권장)

브라우저에서 실시간 그래프로 확인:
```
http://localhost:3000
```

**제공되는 메트릭:**
- 📈 초당 요청 수 (RPS/TPS)
- ⏱️ 응답 시간 분포 (p50, p95, p99)
- ❌ HTTP 에러율
- 🔄 동시 접속자 수 (VUs)

#### 📄 텍스트 결과

테스트 완료 후 콘솔에서 확인:

```
✓ 상태 코드가 200
✓ 응답 시간 < 500ms
✓ 응답 메시지 확인

checks.........................: 95.00% ✓ 285  ✗ 15
data_received..................: 1.2 MB 20 kB/s
data_sent......................: 120 kB 2.0 kB/s
http_req_duration..............: avg=125ms min=50ms med=120ms max=450ms p(95)=350ms
http_reqs......................: 300    5/s
iteration_duration.............: avg=1.12s min=1.05s med=1.11s max=1.45s
iterations.....................: 300    5/s
vus............................: 100    max=100
```