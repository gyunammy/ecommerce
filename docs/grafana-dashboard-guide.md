# Grafana ëŒ€ì‹œë³´ë“œ ì‚¬ìš© ê°€ì´ë“œ

ìƒí’ˆ ëª©ë¡ ì¡°íšŒ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ Grafana ëŒ€ì‹œë³´ë“œì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 1. ì„œë¹„ìŠ¤ ì‹¤í–‰

### ì „ì²´ ì„œë¹„ìŠ¤ ì‹œì‘
```bash
docker-compose up -d
```

InfluxDBì™€ Grafanaê°€ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:
- **InfluxDB**: `http://localhost:8086` (k6 ë©”íŠ¸ë¦­ ì €ì¥ì†Œ)
- **Grafana**: `http://localhost:3000` (ëŒ€ì‹œë³´ë“œ UI)

### ì„œë¹„ìŠ¤ í™•ì¸
```bash
docker-compose ps
```

## 2. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### Dockerë¡œ ì‹¤í–‰
```bash
docker-compose --profile k6 up
```

### Windows ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‹¤í–‰
```bash
run-docker-test.bat
```

k6ê°€ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ìë™ìœ¼ë¡œ InfluxDBì— ë©”íŠ¸ë¦­ì„ ì „ì†¡í•©ë‹ˆë‹¤.

## 3. Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •

### 3.1 Grafana ì ‘ì†
ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†:
```
http://localhost:3000
```

**ë¡œê·¸ì¸ ì •ë³´:**
- Username: `admin`
- Password: `admin`

(ìµëª… ì ‘ì†ë„ í™œì„±í™”ë˜ì–´ ìˆì–´ ìë™ ë¡œê·¸ì¸ë©ë‹ˆë‹¤)

### 3.2 ë°ì´í„° ì†ŒìŠ¤ ì¶”ê°€

1. ì¢Œì¸¡ ë©”ë‰´: **Configuration (âš™ï¸) â†’ Data Sources**
2. **Add data source** í´ë¦­
3. **InfluxDB** ì„ íƒ
4. ì„¤ì • ì…ë ¥:
   - **Query Language**: `InfluxQL`
   - **URL**: `http://influxdb:8086`
   - **Database**: `k6`
   - **HTTP Method**: `GET`
5. **Save & Test** í´ë¦­

### 3.3 k6 ëŒ€ì‹œë³´ë“œ Import

1. ì¢Œì¸¡ ë©”ë‰´: **+ â†’ Import**
2. **Import via grafana.com**ì— ì…ë ¥: `2587`
3. **Load** í´ë¦­
4. ì„¤ì •:
   - **Name**: `k6 Load Testing Results`
   - **InfluxDB**: ë°©ê¸ˆ ìƒì„±í•œ ë°ì´í„° ì†ŒìŠ¤ ì„ íƒ
5. **Import** í´ë¦­

## 4. ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸ ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­

### ğŸ“Š ì£¼ìš” ë©”íŠ¸ë¦­

| ë©”íŠ¸ë¦­ | ì„¤ëª… |
|--------|------|
| **VUs** | ê°€ìƒ ì‚¬ìš©ì ìˆ˜ (ë™ì‹œ ì ‘ì†ì) |
| **Request Rate** | ì´ˆë‹¹ ìš”ì²­ ìˆ˜ (RPS/TPS) |
| **Response Time** | ì‘ë‹µ ì‹œê°„ (p50, p95, p99) |
| **HTTP Failures** | HTTP ì—ëŸ¬ìœ¨ (4xx, 5xx) |
| **Data Sent/Received** | ë„¤íŠ¸ì›Œí¬ ì „ì†¡ëŸ‰ |

### ğŸ¯ ìƒí’ˆ ì¡°íšŒ í…ŒìŠ¤íŠ¸ íŠ¹í™” ë©”íŠ¸ë¦­

k6 ìŠ¤í¬ë¦½íŠ¸ì˜ ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­:
- `successful_requests`: ì„±ê³µí•œ ìš”ì²­ ìˆ˜
- `product_response_time`: ìƒí’ˆ ëª©ë¡ ì¡°íšŒ ì‘ë‹µ ì‹œê°„
- `http_req_duration{name="fetch_products"}`: ìƒí’ˆ ì¡°íšŒ API ì‘ë‹µ ì‹œê°„

### ğŸ“ˆ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘:
- **ì‹¤ì‹œê°„ ê·¸ë˜í”„**ë¡œ ì„±ëŠ¥ ì¶”ì´ í™•ì¸
- **ë¶€í•˜ ì¦ê°€ ì‹œì **ë³„ ì‘ë‹µ ì‹œê°„ ë³€í™” í™•ì¸
- **ë³‘ëª© ì§€ì ** íŒŒì•… (ì‘ë‹µ ì‹œê°„ ê¸‰ì¦ êµ¬ê°„)

## 5. ëŒ€ì‹œë³´ë“œ í™œìš© íŒ

### ì‹œê°„ ë²”ìœ„ ì„¤ì •
- ìš°ì¸¡ ìƒë‹¨ ì‹œê°„ ì„ íƒê¸°ì—ì„œ ë²”ìœ„ ì¡°ì •
- **Last 5 minutes**, **Last 15 minutes** ë“± ì„ íƒ
- **Auto-refresh** í™œì„±í™”ë¡œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

### ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ë¹„êµ
1. InfluxDBì— ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ëˆ„ì 
2. ì‹œê°„ ë²”ìœ„ë¥¼ ì¡°ì •í•˜ì—¬ íŠ¹ì • í…ŒìŠ¤íŠ¸ ì„ íƒ
3. ì„±ëŠ¥ ê°œì„  ì „í›„ ë¹„êµ ê°€ëŠ¥

### íŒ¨ë„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
- íŒ¨ë„ ì œëª© í´ë¦­ â†’ **Edit**
- ì¿¼ë¦¬ ìˆ˜ì •ìœ¼ë¡œ ì›í•˜ëŠ” ë©”íŠ¸ë¦­ ì¶”ê°€
- ì„ê³„ê°’ ì„¤ì •ìœ¼ë¡œ ì„±ëŠ¥ ëª©í‘œ ì‹œê°í™”

## 6. ë¬¸ì œ í•´ê²°

### InfluxDB ì—°ê²° ì‹¤íŒ¨
```bash
# InfluxDB ìƒíƒœ í™•ì¸
docker logs sparta-influxdb

# InfluxDB ì¬ì‹œì‘
docker-compose restart influxdb
```

### ë°ì´í„°ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ
1. k6 í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. ì‹œê°„ ë²”ìœ„ê°€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œê°„ê³¼ ë§ëŠ”ì§€ í™•ì¸
3. InfluxDB ë°ì´í„° í™•ì¸:
```bash
docker exec -it sparta-influxdb influx
> USE k6
> SHOW MEASUREMENTS
> SELECT * FROM http_reqs LIMIT 10
```

### ëŒ€ì‹œë³´ë“œ ë¦¬ì…‹
```bash
# Grafana ë°ì´í„° ì´ˆê¸°í™”
docker-compose down
docker volume rm sparta-e-commerce_grafana-data
docker-compose up -d
```

## 7. ë°ì´í„° ë³´ì¡´

### InfluxDB ë°ì´í„° ìœ ì§€
- Docker volumeì— ì €ì¥ë˜ì–´ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ ì‹œì—ë„ ìœ ì§€ë¨
- ë°ì´í„° ì‚­ì œ ì‹œ:
```bash
docker volume rm sparta-e-commerce_influxdb-data
```

### ê³¼ê±° í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì¡°íšŒ
- Grafana ì‹œê°„ ë²”ìœ„ë¥¼ ê³¼ê±°ë¡œ ì„¤ì •
- ì—¬ëŸ¬ ë²ˆì˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ëˆ„ì ë˜ì–´ ë¹„êµ ê°€ëŠ¥

## 8. ì£¼ìš” URL ì •ë¦¬

| ì„œë¹„ìŠ¤ | URL | ìš©ë„ |
|--------|-----|------|
| Grafana | http://localhost:3000 | ëŒ€ì‹œë³´ë“œ UI |
| InfluxDB | http://localhost:8086 | ë©”íŠ¸ë¦­ ì €ì¥ì†Œ |
| Application | http://localhost:8080 | í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì„œë²„ |

## 9. ì¶”ê°€ ëŒ€ì‹œë³´ë“œ

ê³µì‹ k6 ëŒ€ì‹œë³´ë“œ ì™¸ ì»¤ìŠ¤í…€ ëŒ€ì‹œë³´ë“œë„ import ê°€ëŠ¥:
- **2587**: k6 Load Testing Results (ê³µì‹)
- **10660**: k6 Prometheus
- ì§ì ‘ íŒ¨ë„ êµ¬ì„±í•˜ì—¬ ì¿ í° ë°œê¸‰ íŠ¹í™” ëŒ€ì‹œë³´ë“œ ì œì‘ ê°€ëŠ¥

---

## ì°¸ê³  ìë£Œ
- [k6 InfluxDB ê³µì‹ ë¬¸ì„œ](https://k6.io/docs/results-output/real-time/influxdb/)
- [Grafana k6 ëŒ€ì‹œë³´ë“œ](https://grafana.com/grafana/dashboards/2587)
